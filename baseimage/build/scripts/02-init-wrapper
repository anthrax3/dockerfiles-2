#! /bin/sh

set -e
set -x
export DEBIAN_FRONTEND=noninteractive

##
## install custom init scripts
##
mkdir -p /opt/init-wrapper/sbin /opt/init-wrapper/pre-init.d /opt/init-wrapper/post-init.d
install -m 755 -o root -g root -p /build/opt/init-wrapper/sbin/init      /opt/init-wrapper/sbin/init
install -m 755 -o root -g root -p /build/opt/init-wrapper/pre-init.d/*   /opt/init-wrapper/pre-init.d/
install -m 755 -o root -g root -p /build/opt/init-wrapper/post-init.d/*  /opt/init-wrapper/post-init.d/
install -m 755 -o root -g root -p /build/etc/rc.local                    /etc/rc.local
etckeeper commit 'rc.local: run /opt/init-wrapper/post-init.d/*'

